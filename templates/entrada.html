{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
  <h2 class="text-primary text-center">Entrada de Roupas</h2>
  <form method="POST" action="{{ url_for('entrada') }}">
    <div class="row mb-3">
      <div class="col-md-6">
        <label for="tipo" class="form-label">Tipo de Roupa</label>
        <select class="form-select" id="tipo" name="tipo" required onchange="atualizarCampos()">
          <option value="">Selecione</option>
          <option value="Macacão Azul">Macacão Azul</option>
          <option value="Bota Azul">Bota Azul</option>
          <option value="Óculos">Óculos</option>
          <option value="Panos">Panos</option>
          <option value="Jaleco">Jaleco</option>
          <option value="Camisa">Camisa</option>
          <option value="Calça">Calça</option>
        </select>
      </div>
      <div class="col-md-6">
        <label for="tamanho" class="form-label">Tamanho</label>
        <select class="form-select" id="tamanho" name="tamanho" required>
          <option value="">Selecione o tamanho</option>
        </select>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-md-6">
        <label for="categoria" class="form-label">Categoria</label>
        <input type="text" class="form-control" id="categoria" name="categoria" readonly>
      </div>
      <div class="col-md-6">
        <label for="quantidade" class="form-label">Quantidade</label>
        <input type="number" class="form-control" id="quantidade" name="quantidade" required min="1">
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-md-6">
        <label for="lote" class="form-label">Lote</label>
        <input type="text" class="form-control" id="lote" name="lote">
      </div>
      <div class="col-md-6">
        <label for="validade" class="form-label">Validade</label>
        <input type="date" class="form-control" id="validade" name="validade">
      </div>
    </div>

    <div class="d-grid gap-2">
      <button type="submit" class="btn btn-success btn-lg">
        <i class="bi bi-box-arrow-in-down"></i> Confirmar Entrada
      </button>
      <a href="/" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Voltar ao Início
      </a>
    </div>
  </form>
</div>

<script>
function atualizarCampos() {
  const tipo = document.getElementById('tipo').value;
  const categoriaInput = document.getElementById('categoria');
  const tamanhoSelect = document.getElementById('tamanho');

  const estereis = ['Macacão Azul', 'Bota Azul', 'Óculos', 'Panos'];
  const naoEstereis = ['Jaleco', 'Camisa', 'Calça'];

  if (estereis.includes(tipo)) {
    categoriaInput.value = 'Estéril';
  } else if (naoEstereis.includes(tipo)) {
    categoriaInput.value = 'Não Estéril';
  } else {
    categoriaInput.value = '';
  }

  const tamanhosPorTipo = {
    'Macacão Azul': ['PP', 'P', 'M', 'G', 'GG', 'G3', 'G4'],
    'Bota Azul': ['PP', 'P', 'M', 'G', 'GG', 'G3', 'G4'],
    'Jaleco': ['PP', 'P', 'M', 'G', 'GG', 'G3', 'G4'],
    'Camisa': ['PP', 'P', 'M', 'G', 'GG', 'G3', 'G4'],
    'Calça': ['PP', 'P', 'M', 'G', 'GG', 'G3', 'G4']
  };

  tamanhoSelect.innerHTML = '';

  if (tipo === 'Óculos' || tipo === 'Panos') {
    const opt = document.createElement("option");
    opt.value = 'Padrão';
    opt.textContent = 'Padrão';
    tamanhoSelect.appendChild(opt);
    tamanhoSelect.readOnly = true;
  } else if (tipo in tamanhosPorTipo) {
    const tamanhos = tamanhosPorTipo[tipo];
    const optDefault = document.createElement("option");
    optDefault.value = '';
    optDefault.textContent = 'Selecione o tamanho';
    tamanhoSelect.appendChild(optDefault);

    tamanhos.forEach(tam => {
      const opt = document.createElement("option");
      opt.value = tam;
      opt.textContent = tam;
      tamanhoSelect.appendChild(opt);
    });
    tamanhoSelect.disabled = false;
  } else {
    const opt = document.createElement("option");
    opt.value = "";
    opt.textContent = "Selecione o tamanho";
    tamanhoSelect.appendChild(opt);
    tamanhoSelect.disabled = false;
  }
}
</script>
{% endblock %}
