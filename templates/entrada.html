{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
  <h2 class="text-primary text-center">Entrada de Roupas</h2>
  <form method="POST" action="{{ url_for('entrada') }}">
    <div class="row mb-3">
      <div class="col">
        <label for="tipo" class="form-label">Tipo de Roupa</label>
        <select id="tipo" name="tipo" class="form-select" onchange="atualizarCampos()" required>
          <option value="">Selecione</option>
          <option>Macacão Azul</option>
          <option>Bota Azul</option>
          <option>Óculos</option>
          <option>Panos</option>
          <option>Jaleco</option>
          <option>Camisa</option>
          <option>Calça</option>
        </select>
      </div>
      <div class="col">
        <label for="tamanho" class="form-label">Tamanho</label>
        <select id="tamanho" name="tamanho" class="form-select" required>
          <option value="">Selecione o tamanho</option>
        </select>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col">
        <label for="categoria" class="form-label">Categoria</label>
        <input type="text" id="categoria" name="categoria" class="form-control" readonly required>
      </div>
      <div class="col">
        <label for="quantidade" class="form-label">Quantidade</label>
        <input type="number" id="quantidade" name="quantidade" class="form-control" required>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col">
        <label for="lote" class="form-label">Lote</label>
        <input type="text" id="lote" name="lote" class="form-control">
      </div>
      <div class="col">
        <label for="validade" class="form-label">Validade</label>
        <input type="date" id="validade" name="validade" class="form-control">
      </div>
    </div>

    <button type="submit" class="btn btn-success w-100">Registrar Entrada</button>
    <a href="/" class="btn btn-outline-secondary w-100 mt-2">Voltar ao Início</a>
  </form>
</div>

<script>
function atualizarCampos() {
  const tipo = document.getElementById('tipo').value;
  const categoriaInput = document.getElementById('categoria');
  const tamanhoSelect = document.getElementById('tamanho');

  const estereis = ['Macacão Azul', 'Bota Azul', 'Óculos', 'Panos'];
  const naoEstereis = ['Jaleco', 'Camisa', 'Calça'];

  if (estereis.includes(tipo)) {
    categoriaInput.value = 'Estéril';
  } else if (naoEstereis.includes(tipo)) {
    categoriaInput.value = 'Não Estéril';
  } else {
    categoriaInput.value = '';
  }

  // Define tamanhos possíveis por tipo
  const tamanhosPorTipo = {
    'Macacão Azul': ['PP', 'P', 'M', 'G', 'GG', 'G3', 'G4'],
    'Bota Azul': ['PP', 'P', 'M', 'G', 'GG', 'G3', 'G4'],
    'Jaleco': ['PP', 'P', 'M', 'G', 'GG', 'G3', 'G4'],
    'Camisa': ['PP', 'P', 'M', 'G', 'GG', 'G3', 'G4'],
    'Calça': ['PP', 'P', 'M', 'G', 'GG', 'G3', 'G4'],
    'Óculos': ['Padrão'],
    'Panos': ['Padrão']
  };

  // Limpa o campo tamanho
  tamanhoSelect.innerHTML = '';

  if (tipo in tamanhosPorTipo) {
    const tamanhos = tamanhosPorTipo[tipo];

    tamanhos.forEach(tam => {
      const opt = document.createElement("option");
      opt.value = tam;
      opt.textContent = tam;
      tamanhoSelect.appendChild(opt);
    });

    if (tipo === 'Óculos' || tipo === 'Panos') {
      tamanhoSelect.value = 'Padrão';
      tamanhoSelect.disabled = true;
    } else {
      tamanhoSelect.disabled = false;
    }
  } else {
    const opt = document.createElement("option");
    opt.value = "";
    opt.textContent = "Selecione o tamanho";
    tamanhoSelect.appendChild(opt);
    tamanhoSelect.disabled = false;
  }
}
</script>
{% endblock %}
