{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h2 class="text-center mb-4">Saldo de Roupas</h2>

    <div class="row">
        <div class="col-md-4">
            <ul class="list-group">
                {% for tipo in roupas_por_tipo.keys() %}
                    <li class="list-group-item list-group-item-action" onclick="mostrarSaldo('{{ tipo }}')">
                        {{ tipo }}
                    </li>
                {% endfor %}
            </ul>
        </div>
        <div class="col-md-8">
            <h4 id="titulo-lote" class="mb-3">Selecione um tipo de roupa para visualizar o saldo</h4>
            <div id="saldo-container"></div>
        </div>
    </div>
</div>

<script>
    const roupas = {{ roupas_por_tipo | tojson }};

    function mostrarSaldo(tipo) {
        const container = document.getElementById("saldo-container");
        const titulo = document.getElementById("titulo-lote");
        titulo.innerText = "Saldo de: " + tipo;

        let html = `
            <div class="table-responsive">
                <table class="table table-hover table-bordered align-middle">
                    <thead class="table-primary text-center">
                        <tr>
                            <th>Tamanho</th>
                            <th>Lote</th>
                            <th>Validade</th>
                            <th>Quantidade</th>
                        </tr>
                    </thead>
                    <tbody>
        `;

        roupas[tipo].forEach(function(r) {
            const tamanho = r[2];
            const lote = r[5] || '-';
            const validade = r[6] || '-';
            const qtd = r[4];

            html += `
                <tr class="text-center">
                    <td>${tamanho}</td>
                    <td>${lote}</td>
                    <td>${validade}</td>
                    <td><span class="badge bg-success fs-6">${qtd}</span></td>
                </tr>
            `;
        });

        html += '</tbody></table></div>';
        container.innerHTML = html;
    }
</script>
{% endblock %}
